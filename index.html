<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Estoque - Doce Hype</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || 'dark';
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-mode');
            }
        })();
    </script>

    <style>
        :root {
            --cor-fundo: #f5e3b9; --cor-card: #FFFFFF; --cor-borda: #DED1B1;
            --cor-texto-principal: #4E342E; --cor-texto-secundario: #795548;
            --cor-acento: #8D6E63; --cor-acento-hover: #6D4C41;
            --cor-alerta: #FFA000; --cor-alerta-fundo: #FFF8E1;
            --sombra-card: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        html.dark-mode {
            --cor-fundo: #0D1117; --cor-card: #161B22; --cor-borda: #30363D;
            --cor-texto-principal: #E6EDF3; --cor-texto-secundario: #7D8590;
            --cor-acento: #F72585; --cor-acento-hover: #B5179E;
            --cor-alerta: #F59E0B; --cor-alerta-fundo: rgba(245, 158, 11, 0.1);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', sans-serif; background-color: var(--cor-fundo); color: var(--cor-texto-principal); transition: background-color 0.3s ease, color 0.3s ease; }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1.5rem; }
        .header-title { display: flex; align-items: center; gap: 1rem; }
        .header-title img { height: 40px; width: auto; }
        .header h1 { font-size: 1.8rem; font-weight: 800; color: var(--cor-texto-principal); }
        .header h1 span { display: none; }
        .header-actions { display: flex; align-items: center; gap: 1rem; }
        #theme-toggle {
            background-color: var(--cor-card); border: 1px solid var(--cor-borda); color: var(--cor-texto-secundario);
            font-size: 1.2rem; cursor: pointer; border-radius: 8px; width: 44px; height: 44px;
            display: inline-flex; align-items: center; justify-content: center;
        }
        #theme-toggle:hover { color: var(--cor-texto-principal); background-color: var(--cor-fundo); }
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .kpi-card { background-color: var(--cor-card); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--cor-borda); box-shadow: var(--sombra-card); }
        .kpi-card-title { font-size: 0.9rem; font-weight: 500; color: var(--cor-texto-secundario); margin-bottom: 0.5rem; }
        .kpi-card-value { font-size: 2.25rem; font-weight: 800; color: var(--cor-texto-principal); }
        .kpi-card.alert { border-left: 5px solid var(--cor-alerta); background-color: var(--cor-alerta-fundo); }
        .kpi-card.alert .kpi-card-value { color: var(--cor-alerta); }
        .content-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; }
        .table-container, .list-container { background-color: var(--cor-card); padding: 1.5rem; border-radius: 12px; border: 1px solid var(--cor-borda); box-shadow: var(--sombra-card); }
        .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .table-header h2, .list-container h2 { font-size: 1.1rem; font-weight: 700; margin-bottom: 0; }
        #print-table-button {
            background: none; border: 1px solid var(--cor-borda); color: var(--cor-texto-secundario); font-size: 1.2rem; cursor: pointer;
            border-radius: 8px; width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center;
        }
        #search-input { width: 100%; padding: 0.75rem; border: 1px solid var(--cor-borda); border-radius: 8px; margin-bottom: 1rem; background-color: var(--cor-fundo); color: var(--cor-texto-principal); }
        .table-scroll-wrapper { max-height: 500px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; color: var(--cor-texto-principal); }
        th, td { padding: 0.75rem 1rem; border-bottom: 1px solid var(--cor-borda); text-align: left; }
        th { font-size: 0.8rem; color: var(--cor-texto-secundario); }
        #lista-produtos-wrapper { max-height: 450px; overflow-y: auto; }
        #lista-produtos { list-style: none; padding: 0; }
        #lista-produtos li { display: flex; justify-content: space-between; padding: 0.75rem 0.5rem; border-bottom: 1px solid var(--cor-borda); }
        #lista-produtos li span { font-weight: 500; }
        #lista-produtos li strong { font-weight: 800; font-size: 1.1rem; color: var(--cor-acento); }
        tr.vencimento-proximo { background-color: var(--cor-alerta-fundo) !important; font-weight: bold; }
        tr.vencimento-proximo td { color: var(--cor-alerta) !important; }
        #loading-message { text-align: center; font-size: 1.5rem; padding: 4rem; position: absolute; top: 40%; left: 50%; transform: translateX(-50%); }

        @media (max-width: 1024px) { .content-grid { grid-template-columns: 1fr; } }
        @media (max-width: 768px) {
            body { padding: 0; }
            .container { padding: 1rem; }
            .header { flex-direction: column; align-items: flex-start; }
        }
        @media print {
            body.printing-table > *:not(.table-container) { display: none !important; }
            body.printing-table { padding: 0 !important; }
            .table-container { display: block !important; border: none !important; box-shadow: none !important; width: 100% !important; height: 100% !important; position: absolute; top: 0; left: 0; padding: 20mm; }
            .table-header, #search-input { display: none !important; }
            .table-scroll-wrapper { max-height: none !important; overflow: visible !important; }
        }
    </style>
</head>
<body>
    <div id="loading-message">Carregando Estoque...</div>
    <div id="dashboard-body" style="display: none;" class="container">
        <header class="header">
             <div class="header-title">
                <img src="//dcdn-us.mitiendanube.com/stores/006/776/133/themes/common/logo-1845343579-1759972909-e7a2214e86addc97f23d68fd0ad0f1e41759972910-480-0.webp" alt="Logo Doce Hype">
                <div><h1>Dashboard de Estoque</h1></div>
             </div>
            <div class="header-actions">
                 <button id="theme-toggle" title="Alternar tema"><i class="bi bi-moon-stars-fill"></i></button>
            </div>
        </header>
        <main>
            <section class="kpi-grid">
                <div class="kpi-card">
                    <p class="kpi-card-title">Valor Total (Custo)</p>
                    <p class="kpi-card-value" id="kpi-valor-custo">R$ --</p>
                </div>
                <div class="kpi-card">
                    <p class="kpi-card-title">Valor de Venda (Potencial)</p>
                    <p class="kpi-card-value" id="kpi-valor-venda">R$ --</p>
                </div>
                <div class="kpi-card">
                    <p class="kpi-card-title">Itens em Estoque</p>
                    <p class="kpi-card-value" id="kpi-total-itens">--</p>
                </div>
                <div class="kpi-card" id="kpi-card-vencimento">
                    <p class="kpi-card-title">Itens Próximos ao Vencimento</p>
                    <p class="kpi-card-value" id="kpi-vencimento">--</p>
                </div>
            </section>
            <section class="content-grid">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Inventário de Produtos</h2>
                        <button id="print-table-button" title="Imprimir Tabela"><i class="bi bi-printer-fill"></i></button>
                    </div>
                    <input type="text" id="search-input" placeholder="Buscar produto...">
                    <div class="table-scroll-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Produto</th><th>Qtd.</th><th>Preço Custo</th>
                                    <th>Preço Venda</th><th>Data de Venc.</th><th>Lote</th>
                                </tr>
                            </thead>
                            <tbody id="inventory-table-body"></tbody>
                        </table>
                    </div>
                </div>
                <div class="list-container">
                    <h2>Quantidade por Produto</h2>
                    <div id="lista-produtos-wrapper">
                        <ul id="lista-produtos"></ul>
                    </div>
                </div>
            </section>
        </main>
    </div>
    <script defer src="script.js"></script>
</body>
</html>
